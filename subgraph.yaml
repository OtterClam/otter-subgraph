specVersion: 0.0.2
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: OtterQiLocker
    network: matic
    source:
      address: '0x69f6c4Fa150F9F0b3037612CF8FadDAeDbd46Bb8'
      abi: OtterQiLocker
      startBlock: 25352622
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - ProtocolMetric
        - LogRebase
        - Transfer
        - TreasuryRevenue
        - DystopiaGaugeBalance
        - Vote
        - VotePosition
        - GovernanceMetric
        - TotalBurnedClam
        - Harvest
        - HarvestStaking
      abis:
        - name: OtterQiLocker
          file: ./abis/OtterQiLocker.json
        - name: OtterClamERC20V2
          file: ./abis/OtterClamERC20V2.json
        - name: OtterBondStakeDepository
          file: ./abis/OtterBondStakeDepository.json
        - name: OtterStaking
          file: ./abis/OtterStaking.json
        - name: OtterStakingDistributor
          file: './abis/OtterStakingDistributor.json'
        - name: ClamCirculatingSupply
          file: ./abis/ClamCirculatingSupply.json
        - name: xTetuQi
          file: ./abis/xTetuQi.json
        - name: OtterQiDAOInvestment
          file: ./abis/OtterQiDAOInvestment.json
        - name: QiFarm
          file: ./abis/QiFarm.json
        - name: PearlNote
          file: ./abis/PearlNote.json
        - name: OtterPearlERC20
          file: ./abis/OtterPearlERC20.json
        - name: CurveMai3poolContract
          file: ./abis/CurveMai3poolContract.json        
        - name: Dyst
          file: ./abis/Dyst.json      
        - name: veDyst
          file: ./abis/veDyst.json
        - name: PenDystRewards
          file: ./abis/PenDystRewards.json
        - name: PenLockerV2
          file: ./abis/PenLockerV2.json
        - name: PenLens
          file: ./abis/PenLens.json
        - name: PenrosePartnerRewards
          file: ./abis/PenrosePartnerRewards.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Harvest(uint256)
          handler: handleHarvest
        - event: HarvestStaking(indexed uint256,uint256)
          handler: handleHarvestStaking
      file: ./src/OtterQiLocker.ts

  - kind: ethereum/contract
    name: Dyst
    network: matic
    source:
      address: '0x39aB6574c289c3Ae4d88500eEc792AB5B947A5Eb'
      abi: Dyst
      startBlock: 28347518
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - TreasuryRevenue
      abis:
        - name: Dyst
          file: ./abis/Dyst.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleDystTransfer
      file: ./src/Dyst.ts

  - kind: ethereum/contract
    name: Pen
    network: matic
    source:
      address: '0x39aB6574c289c3Ae4d88500eEc792AB5B947A5Eb'
      abi: Pen
      startBlock: 28829513
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - TreasuryRevenue
      abis:
        - name: Pen
          file: ./abis/Pen.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handlePenTransfer
      file: ./src/Pen.ts

  - kind: ethereum/contract
    name: DeprecatedOtterBuybacker
    network: matic
    source:
      address: '0x017adb26b2ea4dbd9f1372710748e1388fa3082a'
      abi: DeprecatedOtterBuybacker
      startBlock:  24954592
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Buyback
        - TreasuryRevenue
      abis:
        - name: DeprecatedOtterBuybacker
          file: ./abis/DeprecatedOtterBuybacker.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Buyback(indexed address,uint256,uint256)
          handler: handleDeprecatedBuyback
      file: ./src/OtterBuybacker.ts

  - kind: ethereum/contract
    name: OtterBuybacker
    network: matic
    source:
      address: '0x155d21b6d7eb5dd1035a9ae57201c20ff1ea90d2'
      abi: OtterBuybacker
      startBlock:  24954592
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Buyback
        - TreasuryRevenue
      abis:
        - name: OtterBuybacker
          file: ./abis/OtterBuybacker.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Buyback(indexed address,uint256,uint256)
          handler: handleBuyback
      file: ./src/OtterBuybacker.ts


  - kind: ethereum/contract
    name: DystPairFactory
    network: matic
    source:
      address: '0x1d21db6cde1b18c7e47b0f7f42f4b3f68b9beec9'
      abi: DystPairFactory
      startBlock: 27986220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - DystopiaGaugeBalance
      abis:
        - name: Dyst
          file: ./abis/Dyst.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: PairCreated(indexed address,indexed address,bool,address,uint256)
          handler: handlePairCreated
      file: ./src/DystPairFactory.ts

  - kind: ethereum/contract
    name: OtterRewardManager
    network: matic
    source:
      address: '0x306a7c1347F38CAD360a3A31FE0308c33e92c087'
      abi: OtterRewardManager
      startBlock: 27986220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - PearlBankMetric
      abis:
        - name: OtterRewardManager
          file: ./abis/OtterRewardManager.json
        - name: PearlBank
          file: ./abis/PearlBank.json
        - name: OtterClamERC20V2
          file: ./abis/OtterClamERC20V2.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Payout(uint256)
          handler: handlePayout
      file: ./src/OtterRewardManager.ts

  - kind: ethereum/contract
    name: PearlBank
    network: matic
    source:
      address: '0x8787a18F2fcCb87710975CCF71cE931182a505ad'
      abi: PearlBank
      startBlock: 27986220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - PearlBankMetric
      abis:
        - name: PearlBank
          file: ./abis/PearlBank.json
        - name: OtterClamERC20V2
          file: ./abis/OtterClamERC20V2.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Stake(indexed address,uint256,uint256)
          handler: handleStake
        - event: Withdraw(indexed address,uint256,uint256)
          handler: handleWithdraw
      file: ./src/PearlBank.ts

  - kind: ethereum/contract
    name: ClamPond
    network: matic
    source:
      address: '0xF262da77Bc32D4ED026CC4a110b089113651186C'
      abi: ClamPond
      startBlock: 27986220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - PearlBankMetric
      abis:
        - name: ClamPond
          file: ./abis/ClamPond.json
        - name: PearlBank
          file: ./abis/PearlBank.json
        - name: OtterClamERC20V2
          file: ./abis/OtterClamERC20V2.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Deposit(address,uint256)
          handler: handleDeposit
        - event: Withdraw(address,uint256)
          handler: handleWithdraw
      file: ./src/ClamPond.ts

  - kind: ethereum/contract
    name: OttoPortal
    network: matic
    source:
      address: '0xF262da77Bc32D4ED026CC4a110b089113651186C'
      abi: OttoPortal
      startBlock: 26102395
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - OttoMinted
      abis:
        - name: OttoPortal
          file: ./abis/OttoPortal.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: OttoMinted(indexed address,indexed address,uint256)
          handler: handleOttoMinted
      file: ./src/OttoPortal.ts

templates: 
  - kind: ethereum/contract
    name: DystPair
    network: matic
    source:
      abi: DystPair
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - DystopiaGaugeBalance
      abis:
        - name: Dyst
          file: ./abis/Dyst.json
        #====== getPrice() required contracts======
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
        - name: DystRouter
          file: ./abis/DystRouter.json
        - name: UniswapV2Router02
          file: ./abis/UniswapV2Router02.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/DystPair.ts