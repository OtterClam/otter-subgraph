specVersion: 0.0.2
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: StakedOtterClamERC20V2
    network: matic
    source:
      address: '0xAAc144Dc08cE39Ed92182dd85ded60E5000C9e67'
      abi: StakedOtterClamERC20V2
      startBlock:  21593527
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - ProtocolMetric
        - LogRebase
        - Transfer
        - APY
        - TreasuryRevenue
        - DystopiaGaugeBalance
      abis:
        - name: StakedOtterClamERC20V2
          file: ./abis/StakedOtterClamERC20V2.json
        # -- ProtocolMetric --
        - name: OtterClamERC20V2
          file: ./abis/OtterClamERC20V2.json
        - name: OtterBondStakeDepository
          file: ./abis/OtterBondStakeDepository.json
        - name: OtterStaking
          file: ./abis/OtterStaking.json
        - name: OtterStakingDistributor
          file: './abis/OtterStakingDistributor.json'
        - name: ClamCirculatingSupply
          file: ./abis/ClamCirculatingSupply.json
        - name: ERC20
          file: ./abis/ERC20.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: dQuick
          file: ./abis/dQuick.json
        - name: xTetuQi
          file: ./abis/xTetuQi.json
        - name: OtterQiDAOInvestment
          file: ./abis/OtterQiDAOInvestment.json
        - name: QiFarm
          file: ./abis/QiFarm.json
        - name: OtterQuickSwapInvestment
          file: ./abis/OtterQuickSwapInvestment.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: OtterLake
          file: ./abis/OtterLake.json
        - name: PearlNote
          file: ./abis/PearlNote.json
        - name: OtterPearlERC20
          file: ./abis/OtterPearlERC20.json
        - name: CurveMai3poolContract
          file: ./abis/CurveMai3poolContract.json        
        - name: Dyst
          file: ./abis/Dyst.json      
        - name: DystPair
          file: ./abis/DystPair.json
        - name: veDyst
          file: ./abis/veDyst.json
        - name: PenDystRewards
          file: ./abis/PenDystRewards.json
        - name: PenLockerV2
          file: ./abis/PenLockerV2.json
        # --------------------
      eventHandlers:
        - event: LogRebase(indexed uint256,uint256,uint256)
          handler: handleLogRebase
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/StakedOtterClamERC20V2.ts

  - kind: ethereum/contract
    name: OtterClamERC20V2
    network: matic
    source:
      address: '0xc250e9987a032acac293d838726c511e6e1c029d'
      abi: OtterClamERC20V2
      startBlock:  26991825 #First burn transfer
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - TotalBurnedClam
      abis:
        - name: OtterClamERC20V2
          file: ./abis/OtterClamERC20V2.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/OtterClamERC20V2.ts

  - kind: ethereum/contract
    name: OtterLake
    network: matic
    source:
      address: '0xc67aBdA25D0421FE9Dc1afd64183b179A426a256'
      abi: OtterLake
      startBlock: 23553352
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Term
      abis:
        - name: OtterLake
          file: ./abis/OtterLake.json
      eventHandlers:
        - event: TermAdded(indexed address,uint256,uint256,uint16)
          handler: handleTermAdded
        - event: TermUpdated(indexed address,uint8,uint256)
          handler: handleTermUpdated
        - event: TermRemoved(indexed address)
          handler: handleTermRemoved
        - event: TermDisabled(indexed address)
          handler: handleTermDisabled
        - event: Locked(indexed address,indexed address,indexed uint256,uint256)
          handler: handleLocked
        - event: Redeemed(indexed address,indexed address,indexed uint256,uint256)
          handler: handleRedeemed
      file: ./src/OtterLake.ts

  - kind: ethereum/contract
    name: OtterQiLocker
    network: matic
    source:
      address: '0x69f6c4Fa150F9F0b3037612CF8FadDAeDbd46Bb8'
      abi: OtterQiLocker
      startBlock:  25352622
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Harvest
        - HarvestStaking
        - TreasuryRevenue
      abis:
        - name: OtterQiLocker
          file: ./abis/OtterQiLocker.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
      eventHandlers:
        - event: Harvest(uint256)
          handler: handleHarvest
        - event: HarvestStaking(indexed uint256,uint256)
          handler: handleHarvestStaking
      file: ./src/OtterQiLocker.ts

  - kind: ethereum/contract
    name: Qi
    network: matic
    source:
      address: '0x580A84C73811E1839F75d86d75d88cCa0c241fF4'
      abi: Qi
      startBlock:  24088468
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - TreasuryRevenue
        - TotalBribeReward
      abis:
        - name: Qi
          file: ./abis/Qi.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleQiTransfer
      file: ./src/Qi.ts

  #Penrose staking rewards
  # - kind: ethereum/contract
  #   name: MultiRewards
  #   network: matic
  #   source:
  #     address: '0x4edc2f4368179be77e5e8fba295fff0a82e3df21'
  #     abi: MultiRewards
  #     startBlock: 29069971
  #   mapping:
  #     kind: ethereum/events
  #     apiVersion: 0.0.5
  #     language: wasm/assemblyscript
  #     entities:
  #       - Transaction
  #       - Transfer
  #       - TreasuryRevenue
  #     abis:
  #       - name: Dyst
  #         file: ./abis/Dyst.json
  #       - name: UniswapV2Pair
  #         file: ./abis/UniswapV2Pair.json
  #       - name: AggregatorV3InterfaceABI
  #         file: ./abis/AggregatorV3InterfaceABI.json
  #       - name: DystPair
  #         file: ./abis/DystPair.json
  #       - name: MultiRewards
  #         file: ./abis/MultiRewards.json
  #     eventHandlers:
  #       - event: RewardPaid(indexed address,indexed address,uint256)
  #         handler: handleRewardPaid
  #     file: ./src/MultiRewards.ts

  - kind: ethereum/contract
    name: Dyst
    network: matic
    source:
      address: '0x39aB6574c289c3Ae4d88500eEc792AB5B947A5Eb'
      abi: Dyst
      startBlock:  28347518
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - TreasuryRevenue
      abis:
        - name: Dyst
          file: ./abis/Dyst.json
        - name: Pen
          file: ./abis/Pen.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleDystTransfer
      file: ./src/Dyst.ts

  - kind: ethereum/contract
    name: Pen
    network: matic
    source:
      address: '0x39aB6574c289c3Ae4d88500eEc792AB5B947A5Eb'
      abi: Pen
      startBlock: 28829513
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - TreasuryRevenue
      abis:
        - name: Pen
          file: ./abis/Pen.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handlePenTransfer
      file: ./src/Pen.ts

  - kind: ethereum/contract
    name: DeprecatedOtterBuybacker
    network: matic
    source:
      address: '0x017adb26b2ea4dbd9f1372710748e1388fa3082a'
      abi: DeprecatedOtterBuybacker
      startBlock:  24954592
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Buyback
        - TreasuryRevenue
      abis:
        - name: DeprecatedOtterBuybacker
          file: ./abis/DeprecatedOtterBuybacker.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
      eventHandlers:
        - event: Buyback(indexed address,uint256,uint256)
          handler: handleDeprecatedBuyback
      file: ./src/OtterBuybacker.ts

  - kind: ethereum/contract
    name: OtterBuybacker
    network: matic
    source:
      address: '0x155d21b6d7eb5dd1035a9ae57201c20ff1ea90d2'
      abi: OtterBuybacker
      startBlock:  24954592
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Buyback
        - TreasuryRevenue
      abis:
        - name: OtterBuybacker
          file: ./abis/OtterBuybacker.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
      eventHandlers:
        - event: Buyback(indexed address,uint256,uint256)
          handler: handleBuyback
      file: ./src/OtterBuybacker.ts

  # - kind: ethereum/contract
  #   name: DystVoter
  #   network: matic
  #   source:
  #     address: '0x649BdF58B09A0Cd4Ac848b42c4B5e1390A72A49A'
  #     abi: DystVoter
  #     startBlock: 
  #   mapping:
  #     kind: ethereum/events
  #     apiVersion: 0.0.5
  #     language: wasm/assemblyscript
  #     entities:
  #       - Transaction
  #       - Transfer
  #       - DystopiaGaugeBalance
  #     abis:
  #       - name: Dyst
  #         file: ./abis/Dyst.json
  #       - name: UniswapV2Pair
  #         file: ./abis/UniswapV2Pair.json
  #       - name: AggregatorV3InterfaceABI
  #         file: ./abis/AggregatorV3InterfaceABI.json
  #       - name: DystPair
  #         file: ./abis/DystPair.json
  #       - name: DystVoter
  #         file: ./abis/DystVoter.json
  #     eventHandlers:
  #       - event: Abstained(uint tokenId, int256 weight)
  #         handler: handleAbstained
  #       - event: Voted(address indexed voter, uint tokenId, int256 weight)
  #         handler: handleVoted
  #     file: ./src/DystVoter.ts

  - kind: ethereum/contract
    name: DystPairFactory
    network: matic
    source:
      address: '0x1d21db6cde1b18c7e47b0f7f42f4b3f68b9beec9'
      abi: DystPairFactory
      startBlock: 27986220
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - DystopiaGaugeBalance
      abis:
        - name: Dyst
          file: ./abis/Dyst.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystVoter
          file: ./abis/DystVoter.json
        - name: DystPairFactory
          file: ./abis/DystPairFactory.json
      eventHandlers:
        - event: PairCreated(indexed address,indexed address,bool,address,uint256)
          handler: handlePairCreated
      file: ./src/DystPairFactory.ts

templates: 
  - kind: ethereum/contract
    name: DystPair
    network: matic
    source:
      abi: DystPair
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Transaction
        - Transfer
        - DystopiaGaugeBalance
      abis:
        - name: Dyst
          file: ./abis/Dyst.json
        - name: UniswapV2Pair
          file: ./abis/UniswapV2Pair.json
        - name: AggregatorV3InterfaceABI
          file: ./abis/AggregatorV3InterfaceABI.json
        - name: DystPair
          file: ./abis/DystPair.json
        - name: DystVoter
          file: ./abis/DystVoter.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/DystPair.ts